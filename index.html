<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>üíå Valentine?</title>
  <style>
    :root{
      --bg1:#0b1020;
      --bg2:#2a0f2f;
      --card: rgba(255,255,255,.08);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.72);
      --accent:#ff4d8d;
      --accent2:#ffd1e1;
      --shadow: 0 20px 60px rgba(0,0,0,.45);
      --radius: 22px;
      --border: 1px solid rgba(255,255,255,.14);
      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--font);
      color:var(--text);

      /* ‚úÖ mobile-friendly: allow scrolling, no horizontal overflow */
      overflow-x:hidden;
      overflow-y:auto;
      -webkit-overflow-scrolling: touch;

      background:
        radial-gradient(1200px 800px at 20% 10%, rgba(255,77,141,.20), transparent 60%),
        radial-gradient(900px 700px at 80% 30%, rgba(255,209,225,.12), transparent 60%),
        linear-gradient(135deg, var(--bg1), var(--bg2));
    }

    /* floating hearts layer */
    .hearts{
      position:fixed; inset:0;
      pointer-events:none;
      overflow:hidden;
      filter: drop-shadow(0 10px 20px rgba(0,0,0,.35));
    }
    .heart{
      position:absolute;
      font-size:18px;
      opacity:0;
      transform: translateY(20px);
      animation: floatUp linear forwards;
      will-change: transform, opacity;
    }
    @keyframes floatUp{
      0%{ opacity:0; transform: translateY(40px) scale(.9); }
      10%{ opacity:.8; }
      100%{ opacity:0; transform: translateY(-120svh) scale(1.25); }
    }

    /* main layout */
    .wrap{
      position:relative;

      /* ‚úÖ better on mobile browser UI bars */
      min-height: 100svh;

      display:grid;
      place-items:center;
      padding:24px;
      padding-bottom: max(24px, env(safe-area-inset-bottom));
      padding-top: max(24px, env(safe-area-inset-top));
    }

    .card{
      width:min(720px, 94vw);
      background: linear-gradient(180deg, var(--card), rgba(255,255,255,.04));
      border:var(--border);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(14px);
    }

    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:16px 18px;
      border-bottom:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.14);
    }

    .brand{
      display:flex; gap:10px; align-items:center;
      font-weight:700; letter-spacing:.2px;
      min-width: 0;
    }
    #titleText{
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width: 45vw;
    }

    .dot{
      width:10px; height:10px; border-radius:50%;
      background:var(--accent);
      box-shadow: 0 0 18px rgba(255,77,141,.8);
      flex:0 0 auto;
    }

    .actions{
      display:flex; gap:10px; align-items:center;
      flex:0 0 auto;
    }
    .iconbtn{
      appearance:none; border:var(--border);
      background: rgba(255,255,255,.06);
      color:var(--text);
      padding:10px 12px;
      border-radius:14px;
      cursor:pointer;
      transition:.2s transform, .2s background;
      font-weight:600;
      white-space:nowrap;
    }
    .iconbtn:hover{ transform: translateY(-1px); background: rgba(255,255,255,.10); }

    .content{
      padding:28px 22px 22px;
      display:grid;
      gap:18px;
    }

    .headline{
      font-size: clamp(28px, 5vw, 44px);
      line-height:1.05;
      margin:0;
      letter-spacing:-.02em;
      word-break: break-word;
    }

    .sub{
      margin:0;
      color:var(--muted);
      font-size: clamp(14px, 3.2vw, 17px);
      line-height:1.5;
    }

    .type{
      font-weight:700;
      color:var(--accent2);
      white-space:nowrap;
      border-right:2px solid rgba(255,255,255,.55);
      padding-right:6px;
      animation: caret 1s steps(1) infinite;
    }
    @keyframes caret{ 50%{ border-right-color: transparent; } }

    .questionBox{
      margin-top:8px;
      border-radius:18px;
      background: linear-gradient(180deg, rgba(255,77,141,.14), rgba(255,255,255,.04));
      border:1px solid rgba(255,77,141,.22);
      padding:18px 16px;
      display:grid;
      gap:10px;
    }

    .btnRow{
      /* ‚úÖ create a ‚Äúplayground‚Äù area for No button on mobile */
      position:relative;
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      margin-top:6px;
      padding-bottom:6px;
      align-items:center;
    }

    .btn{
      appearance:none;
      border:none;
      cursor:pointer;
      border-radius:16px;
      padding:14px 18px;
      font-weight:800;
      letter-spacing:.2px;
      transition:.2s transform, .2s filter;
      user-select:none;
    }
    .btn:active{ transform: translateY(1px) scale(.99); }

    .yes{
      background: linear-gradient(135deg, var(--accent), #ff7ab0);
      color:white;
      box-shadow: 0 18px 40px rgba(255,77,141,.32);
    }
    .yes:hover{ filter: brightness(1.05); transform: translateY(-1px); }

    .no{
      background: rgba(255,255,255,.10);
      color: rgba(255,255,255,.88);
      border: var(--border);
    }
    .no:hover{ transform: translateY(-1px); }

    .footerNote{
      color: rgba(255,255,255,.55);
      font-size: 12px;
      margin-top: 8px;
    }

    .final{
      display:none;
      padding:22px 16px;
      border-radius:18px;
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.05));
      border: var(--border);
    }
    .final h2{
      margin:0 0 8px;
      font-size: 26px;
      letter-spacing:-.02em;
    }
    .final p{ margin:0; color:var(--muted); line-height:1.5; }

    .chips{
      margin-top:14px;
      display:flex; flex-wrap:wrap; gap:10px;
    }
    .chip{
      padding:10px 12px;
      border-radius:999px;
      border: var(--border);
      background: rgba(255,255,255,.06);
      font-weight:700;
      font-size: 13px;
    }

    canvas#confetti{
      position:fixed;
      inset:0;
      pointer-events:none;
    }

    /* ‚úÖ MOBILE: card becomes more ‚Äúfull screen‚Äù, buttons stack nicely */
    @media (max-width:520px){
      .wrap{ padding:14px; }
      .card{
        width: 100%;
        border-radius: 18px;
      }
      .content{ padding:20px 16px 16px; }
      .actions{ gap:8px; }
      .iconbtn{ padding:9px 10px; border-radius:12px; }
      .btn{ width:100%; }
      #titleText{ max-width: 40vw; }
    }

    /* ‚úÖ very small phones */
    @media (max-width:360px){
      .headline{ font-size: 28px; }
      .final h2{ font-size: 22px; }
      .chip{ font-size: 12px; padding:9px 10px; }
    }
  </style>
</head>
<body>
  <canvas id="confetti"></canvas>
  <div class="hearts" id="hearts"></div>

  <div class="wrap">
    <div class="card" role="application" aria-label="Valentine page">
      <div class="topbar">
        <div class="brand">
          <span class="dot"></span>
          <span id="titleText">A tiny question‚Ä¶</span>
        </div>
        <div class="actions">
          <button class="iconbtn" id="musicBtn" title="Toggle music">‚ô™ Music: Off</button>
          <button class="iconbtn" id="resetBtn" title="Reset">‚Üª Reset</button>
        </div>
      </div>

      <div class="content">
        <div>
          <h1 class="headline">
            Hey <span id="crushName">[Her Name]</span> üíó
          </h1>
          <p class="sub">
            I made this just for you‚Ä¶ <span class="type" id="typeText"></span>
          </p>
        </div>

        <div class="questionBox" id="mainBox">
          <p class="sub" style="margin:0">
            So here‚Äôs the real question:
          </p>
          <div style="display:flex; align-items:center; gap:10px; flex-wrap:wrap;">
            <span style="font-size:22px; font-weight:900;">Will you be my Valentine?</span>
            <span style="opacity:.9">üåπ</span>
          </div>

          <div class="btnRow" id="btnRow">
            <button class="btn yes" id="yesBtn">Yes üíò</button>
            <button class="btn no" id="noBtn">No üôÉ</button>
          </div>

          <div class="footerNote">Can you say no ?</div>
        </div>

        <div class="final" id="finalBox">
          <h2>Yesss! üéâüíû</h2>
          <p id="finalMsg">You just made my day. Want to go out and celebrate?</p>
          <div class="chips">
            <span class="chip">üçï Pizza / Kottu date</span>
            <span class="chip">üé¨ Movie night</span>
            <span class="chip">üç¶ Ice cream</span>
            <span class="chip">üì∏ Cute selfies</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <audio id="bgm" loop>
    <source src="song.mp3" type="audio/mpeg">
  </audio>

  <script>
    // ========= Customize here =========
    const NAME = "My Favorite Person";
    const TYPE_LINES = [
      "I hope you smile reading this.",
      "I was a little nervous to ask‚Ä¶",
      "but I wanted to be brave today."
    ];
    const FINAL_MESSAGE = "If you're free, can I take you out this Valentine‚Äôs? üíó";

    // ========= DOM =========
    const crushName = document.getElementById("crushName");
    const typeText = document.getElementById("typeText");
    const yesBtn = document.getElementById("yesBtn");
    const noBtn = document.getElementById("noBtn");
    const btnRow = document.getElementById("btnRow");
    const finalBox = document.getElementById("finalBox");
    const finalMsg = document.getElementById("finalMsg");
    const resetBtn = document.getElementById("resetBtn");
    const hearts = document.getElementById("hearts");
    const titleText = document.getElementById("titleText");

    const musicBtn = document.getElementById("musicBtn");
    const bgm = document.getElementById("bgm");

    crushName.textContent = NAME;
    finalMsg.textContent = FINAL_MESSAGE;

    // ========= Typewriter =========
    let lineIdx = 0, charIdx = 0, typing = true;
    function typeLoop(){
      if(!typing) return;
      const line = TYPE_LINES[lineIdx] ?? "";
      typeText.textContent = line.slice(0, charIdx);

      charIdx++;
      if(charIdx > line.length){
        setTimeout(() => {
          lineIdx = (lineIdx + 1) % TYPE_LINES.length;
          charIdx = 0;
        }, 900);
      }
      setTimeout(typeLoop, 45);
    }
    typeLoop();

    // ========= Floating hearts =========
    const heartEmojis = ["üíó","üíñ","üíò","üíù","üíï","üå∏"];
    function spawnHeart(){
      const h = document.createElement("div");
      h.className = "heart";
      h.textContent = heartEmojis[Math.floor(Math.random()*heartEmojis.length)];
      const left = Math.random()*100;
      const size = 14 + Math.random()*18;
      const dur = 6 + Math.random()*6;
      h.style.left = left + "vw";
      h.style.bottom = "-30px";
      h.style.fontSize = size + "px";
      h.style.animationDuration = dur + "s";
      hearts.appendChild(h);
      requestAnimationFrame(()=>{ h.style.opacity = "1"; });
      setTimeout(()=> h.remove(), dur*1000);
    }
    let heartTimer = setInterval(spawnHeart, 650);

    // ========= "No" button dodging (mobile-safe) =========
    function clamp(v, min, max){ return Math.max(min, Math.min(max, v)); }

    function moveNo(){
      const rowRect = btnRow.getBoundingClientRect();
      const noRect = noBtn.getBoundingClientRect();

      // movement bounds inside btnRow
      const padding = 6;
      const maxX = Math.max(0, rowRect.width - noRect.width - padding*2);
      const maxY = Math.max(0, 70);

      const targetX = (Math.random() * maxX) - (maxX/2);
      const targetY = (Math.random() * maxY) - 10;

      // ‚úÖ keep movement limited on small screens
      const isMobile = window.matchMedia("(max-width: 520px)").matches;
      const x = isMobile ? clamp(targetX, -40, 40) : targetX;
      const y = isMobile ? clamp(targetY, -8, 26) : targetY;

      noBtn.style.position = "relative";
      noBtn.style.left = x + "px";
      noBtn.style.top  = y + "px";
    }

    let noCount = 0;
    noBtn.addEventListener("mouseenter", () => {
      noCount++;
      moveNo();
      titleText.textContent = noCount > 2 ? "Nice try üòÑ" : "A tiny question‚Ä¶";
      if(noCount === 4) noBtn.textContent = "Still no? üòÖ";
      if(noCount === 6) noBtn.textContent = "Okay okay‚Ä¶ üôà";
    });

    // ‚úÖ mobile uses touch, so move on touchstart too
    noBtn.addEventListener("touchstart", (e) => {
      e.preventDefault();
      noCount++;
      moveNo();
    }, {passive:false});

    noBtn.addEventListener("click", (e) => {
      e.preventDefault();
      moveNo();
    });

    // ========= Confetti =========
    const canvas = document.getElementById("confetti");
    const ctx = canvas.getContext("2d");
    let confetti = [];

    function resize(){
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener("resize", resize);
    resize();

    function shootConfetti(){
      const count = 220;
      confetti = [];
      for(let i=0;i<count;i++){
        confetti.push({
          x: Math.random()*canvas.width,
          y: -20 - Math.random()*canvas.height*0.2,
          r: 2 + Math.random()*4,
          vx: -2 + Math.random()*4,
          vy: 2 + Math.random()*6,
          rot: Math.random()*Math.PI,
          vr: -0.2 + Math.random()*0.4,
          a: 1
        });
      }
      animateConfetti();
    }

    let confettiAnimating = false;
    function animateConfetti(){
      if(confettiAnimating) return;
      confettiAnimating = true;

      function frame(){
        ctx.clearRect(0,0,canvas.width,canvas.height);
        for(const p of confetti){
          p.x += p.vx;
          p.y += p.vy;
          p.rot += p.vr;
          p.vy += 0.05;
          p.a -= 0.004;

          ctx.save();
          ctx.globalAlpha = Math.max(0, p.a);
          ctx.translate(p.x, p.y);
          ctx.rotate(p.rot);
          ctx.fillStyle = `hsl(${Math.floor(Math.random()*360)}, 90%, 70%)`;
          ctx.fillRect(-p.r, -p.r, p.r*2.2, p.r*1.4);
          ctx.restore();
        }
        confetti = confetti.filter(p => p.a > 0 && p.y < canvas.height + 40);
        if(confetti.length){
          requestAnimationFrame(frame);
        }else{
          confettiAnimating = false;
          ctx.clearRect(0,0,canvas.width,canvas.height);
        }
      }
      requestAnimationFrame(frame);
    }

    // ========= Yes flow =========
    yesBtn.addEventListener("click", () => {
      finalBox.style.display = "block";
      yesBtn.disabled = true;
      noBtn.disabled = true;
      yesBtn.textContent = "Yay! üíû";
      titleText.textContent = "She said YES üíò";
      shootConfetti();

      clearInterval(heartTimer);
      let burst = 0;
      const burstTimer = setInterval(() => {
        spawnHeart(); spawnHeart();
        burst++;
        if(burst > 14){
          clearInterval(burstTimer);
          heartTimer = setInterval(spawnHeart, 700);
        }
      }, 120);

      finalBox.scrollIntoView({behavior:"smooth", block:"nearest"});
    });

    // ========= Reset =========
    resetBtn.addEventListener("click", () => {
      noCount = 0;
      noBtn.textContent = "No üôÉ";
      noBtn.style.left = "0px";
      noBtn.style.top = "0px";
      noBtn.disabled = false;
      yesBtn.disabled = false;
      yesBtn.textContent = "Yes üíò";
      finalBox.style.display = "none";
      titleText.textContent = "A tiny question‚Ä¶";
      ctx.clearRect(0,0,canvas.width,canvas.height);
    });

    // ========= Music toggle =========
    let musicOn = false;
    musicBtn.addEventListener("click", async () => {
      try{
        if(!musicOn){
          await bgm.play();
          musicOn = true;
          musicBtn.textContent = "‚ô™ Music: On";
        }else{
          bgm.pause();
          musicOn = false;
          musicBtn.textContent = "‚ô™ Music: Off";
        }
      }catch(e){
        alert("Add an audio file (song.mp3) next to this HTML or set the <source src='...'> in the code.");
      }
    });
  </script>
</body>
</html>
